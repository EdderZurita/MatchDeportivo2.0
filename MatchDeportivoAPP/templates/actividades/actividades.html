{% extends 'base_usuario.html' %}
{% load static %}

{% block title %}Actividades | SportConnect{% endblock %}

{% block extra_css %}
<!-- Estilos externos para actividades -->
<link href="{% static 'css/actividades.css' %}" rel="stylesheet">
{% endblock %}

{% block usuario_content %}
<div class="container">
  <!-- Header azul -->
  <div class="activities-header">
    <h2>Actividades Deportivas</h2>
    <p>Explora, únete o administra tus actividades deportivas</p>
  </div>

  <!-- Botones de acción -->
  <div class="activity-actions">
    <a href="{% url 'crear_actividad' %}" class="btn btn-success">Crear actividad</a>
    <a href="{% url 'mis_actividades' %}" class="btn btn-secondary">Mis actividades</a>
  </div>

  <!-- Filtro por deporte -->
  <div class="filter-section">
    <form method="GET" class="filter-form">
      <select name="deporte" class="form-select">
        <option value="">-- Filtrar por deporte --</option>
        <option value="futbol" {% if deporte_seleccionado ==  'futbol' %}selected{% endif %}>Fútbol</option>
        <option value="basketball" {% if deporte_seleccionado == 'basketball' %}selected{% endif %}>Basketball</option>
        <option value="skate" {% if deporte_seleccionado == 'skate' %}selected{% endif %}>Skate</option>
        <option value="volibol" {% if deporte_seleccionado == 'volibol' %}selected{% endif %}>Vóleibol</option>
        <option value="running" {% if deporte_seleccionado == 'running' %}selected{% endif %}>Running</option>
        <option value="tenis" {% if deporte_seleccionado == 'tenis' %}selected{% endif %}>Tenis</option>
      </select>

      <button type="submit" class="btn btn-primary">
        Buscar
      </button>
    </form>
  </div>

  <!-- Lista de actividades -->
  <div class="row">
    {% if actividades %}
    {% for actividad in actividades %}
    <div class="col-md-6">
      <div class="activity-card">
        <!-- Título -->
        <div class="activity-title">{{ actividad.titulo }}</div>

        <!-- Deporte -->
        <div class="activity-info">
          Deporte: <strong>{{ actividad.deporte|capfirst }}</strong>
        </div>

        <!-- Ubicación -->
        <div class="activity-info">
          Lugar: <strong>{{ actividad.lugar }}</strong>
        </div>

        <!-- Fecha y hora -->
        <div class="activity-info">
          Fecha: {{ actividad.fecha|date:"D d M" }} | Hora: {{ actividad.hora_inicio|time:"H:i" }}{% if actividad.hora_fin %} - {{ actividad.hora_fin|time:"H:i" }}{% endif %}
        </div>

        <!-- Cupos y nivel -->
        <div class="activity-info">
          Cupos disponibles: {{ actividad.cupos }} | Nivel: <strong>**{{ actividad.nivel }}**</strong>
        </div>

        <!-- Botón ver detalles -->
        <div class="mt-3">
          <a href="{% url 'detalle_actividad' pk=actividad.pk %}" class="btn btn-primary btn-sm">
            Ver detalles
          </a>
        </div>
      </div>
    </div>
    {% endfor %}

    <!-- Paginación -->
    {% if actividades.has_other_pages %}
    <nav aria-label="Paginación de actividades" class="mt-3">
      <ul class="pagination justify-content-center">
        {% if actividades.has_previous %}
        <li class="page-item">
          <a class="page-link"
            href="?page={{ actividades.previous_page_number }}{% if deporte_seleccionado %}&deporte={{ deporte_seleccionado }}{% endif %}">Anterior</a>
        </li>
        {% endif %}

        {% for num in actividades.paginator.page_range %}
        {% if actividades.number == num %}
        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
        {% else %}
        <li class="page-item">
          <a class="page-link"
            href="?page={{ num }}{% if deporte_seleccionado %}&deporte={{ deporte_seleccionado }}{% endif %}">{{ num
            }}</a>
        </li>
        {% endif %}
        {% endfor %}

        {% if actividades.has_next %}
        <li class="page-item">
          <a class="page-link"
            href="?page={{ actividades.next_page_number }}{% if deporte_seleccionado %}&deporte={{ deporte_seleccionado }}{% endif %}">Siguiente</a>
        </li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}

    {% else %}
    <div class="col-12">
      <div class="alert alert-info" role="alert">
        No se encontraron actividades disponibles
        {% if deporte_seleccionado %} para el deporte "{{ deporte_seleccionado|capfirst }}"{% endif %}.
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}