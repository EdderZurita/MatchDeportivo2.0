{% extends 'base_usuario.html' %}
{% load static %}

{% block title %}Gestionar Participantes{% endblock %}

{% block usuario_content %}

<div class="container mt-5">
Â  <div class="card shadow p-4">
Â  Â  <h2 class="text-center mb-4">ğŸ‘¥ GestiÃ³n de Participantes</h2>
Â  Â  <p class="text-center text-muted">Administra los usuarios inscritos en tu actividad</p>

Â  Â  <!-- InformaciÃ³n de la actividad (dinÃ¡mica) -->
Â  Â  <div class="mb-4 text-center">
Â  Â  Â  <h4>ğŸ† {{ actividad.titulo }}</h4>
Â  Â  Â  <p>
<strong>Lugar:</strong> {{ actividad.lugar }} |
<strong>Fecha:</strong> {{ actividad.fecha|date:"d M Y" }} |
<strong>Hora:</strong> {{ actividad.hora_inicio|time:"H:i" }}
</p>
<p class="mb-0"><strong>Inscritos:</strong> {{ participantes|length }} / Cupos restantes: {{ actividad.cupos }}</p>
Â  Â  </div>

Â  Â  <!-- Tabla de participantes -->
Â  Â  <table class="table table-hover align-middle">
Â  Â  Â  <thead class="table-primary text-center">
Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  <th>#</th>
Â  Â  Â  Â  Â  <th>Nombre</th>
Â  Â  Â  Â  Â  <th>Usuario</th>
Â  Â  Â  Â  Â  <th>Nivel</th>
Â  Â  Â  Â  Â  <th>Acciones</th>
Â  Â  Â  Â  </tr>
Â  Â  Â  </thead>
Â  Â  Â  <tbody class="text-center">
{% for p in participantes %}
Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  <td>{{ forloop.counter }}</td>
Â  Â  Â  Â  Â  <td>
{{ p.perfil.nombre_completo|default:p.user.username }}
</td>
Â  Â  Â  Â  Â  <td>@{{ p.user.username }}</td>
Â  Â  Â  Â  Â  <td>
<span class="badge bg-info">{{ p.perfil.nivel|default:'N/E' }}</span>
</td>
Â  Â  Â  Â  Â  <td>
<!-- Enlace para ver el perfil del participante -->
Â  Â  Â  Â  Â  Â  <a href="{% url 'perfil_participante' user_id=p.user.id %}" class="btn btn-primary btn-sm">Ver Perfil</a>

            <!-- Enlace para QUITAR (Betar/Sacar) al participante -->
            <a href="{% url 'quitar_participante' actividad_pk=actividad.pk user_id=p.user.id %}" class="btn btn-danger btn-sm" 
               onclick="return confirm('Â¿EstÃ¡s seguro de que deseas quitar a {{ p.user.username }} de la actividad? Esto liberarÃ¡ su cupo.');">
               Quitar
            </a>


Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  </tr>
{% empty %}
<tr>
<td colspan="5">AÃºn no hay participantes inscritos.</td>
</tr>
{% endfor %}
Â  Â  Â  </tbody>
Â  Â  </table>

Â  Â  <div class="text-end mt-4">
Â  Â  Â  <a href="{% url 'editar_actividad' pk=actividad.pk %}" class="btn btn-outline-secondary">â¬… Volver a EdiciÃ³n</a>
Â  Â  </div>
Â  </div>

</div>

<style>
 .badge {
 font-size: 0.85rem;
 }
 .btn-sm {
 margin: 0 0.2rem;
 }
</style>

{% endblock usuario_content %}